# ‡πÅ‡∏û‡∏•‡∏ï‡∏ü‡∏≠‡∏£‡πå‡∏°‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏£‡∏π‡πâ Observability üîç

![Observability Learning Platform](./documents/intro.png)

‡∏£‡∏∞‡∏ö‡∏ö microservices ‡∏™‡∏∏‡∏î‡πÄ‡∏à‡πã‡∏á‡∏ó‡∏µ‡πà‡∏≠‡∏≠‡∏Å‡πÅ‡∏ö‡∏ö‡∏°‡∏≤‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡∏Ñ‡∏∏‡∏ì‡πÑ‡∏î‡πâ‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏£‡∏π‡πâ‡∏ß‡∏¥‡∏ò‡∏µ‡∏Å‡∏≤‡∏£‡∏ó‡∏≥ observability ‡πÅ‡∏ö‡∏ö‡∏ó‡∏±‡∏ô‡∏™‡∏°‡∏±‡∏¢‡∏î‡πâ‡∏ß‡∏¢ Azure Application Insights ‡∏Ñ‡∏£‡∏±‡∏ö! ‡∏£‡∏∞‡∏ö‡∏ö‡∏ô‡∏µ‡πâ‡∏õ‡∏£‡∏∞‡∏Å‡∏≠‡∏ö‡∏î‡πâ‡∏ß‡∏¢ .NET 8 Web APIs ‡∏™‡∏≠‡∏á‡∏ï‡∏±‡∏ß‡∏ó‡∏µ‡πà‡∏à‡∏∞‡∏à‡∏≥‡∏•‡∏≠‡∏á‡∏õ‡∏±‡∏ç‡∏´‡∏≤ performance ‡∏ï‡πà‡∏≤‡∏á‡πÜ ‡∏ó‡∏µ‡πà‡πÄ‡∏à‡∏≠‡πÉ‡∏ô‡πÇ‡∏•‡∏Å‡∏à‡∏£‡∏¥‡∏á ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡∏Ñ‡∏∏‡∏ì‡πÑ‡∏î‡πâ‡∏ù‡∏∂‡∏Å‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡πÅ‡∏•‡∏∞‡πÅ‡∏Å‡πâ‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡πÅ‡∏ö‡∏ö‡∏°‡∏∑‡∏≠‡∏≠‡∏≤‡∏ä‡∏µ‡∏û

## ‡∏†‡∏≤‡∏û‡∏£‡∏ß‡∏°‡∏£‡∏∞‡∏ö‡∏ö üöÄ

‡πÅ‡∏û‡∏•‡∏ï‡∏ü‡∏≠‡∏£‡πå‡∏°‡∏ô‡∏µ‡πâ‡∏à‡∏≥‡∏•‡∏≠‡∏á‡∏£‡∏∞‡∏ö‡∏ö distributed ‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏õ‡∏±‡∏ç‡∏´‡∏≤ performance ‡∏ï‡πà‡∏≤‡∏á‡πÜ ‡∏ó‡∏µ‡πà‡∏ï‡∏±‡πâ‡∏á‡πÉ‡∏à‡πÉ‡∏™‡πà‡πÄ‡∏Ç‡πâ‡∏≤‡πÑ‡∏õ ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡∏ô‡∏±‡∏Å‡∏û‡∏±‡∏í‡∏ô‡∏≤‡πÑ‡∏î‡πâ‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏£‡∏π‡πâ:
- **Latency Analysis**: ‡∏´‡∏≤‡∏ß‡πà‡∏≤ service ‡πÑ‡∏´‡∏ô‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡∏£‡∏∞‡∏ö‡∏ö‡∏ä‡πâ‡∏≤‡πÉ‡∏ô‡∏™‡∏≤‡∏¢ distributed call
- **Root Cause Analysis**: ‡∏ï‡∏≤‡∏°‡∏£‡∏≠‡∏¢ error ‡∏à‡∏≤‡∏Å API ‡∏´‡∏ô‡πâ‡∏≤‡∏ö‡πâ‡∏≤‡∏ô‡πÑ‡∏õ‡∏¢‡∏±‡∏á service ‡∏´‡∏•‡∏±‡∏á‡∏ö‡πâ‡∏≤‡∏ô
- **Resource Monitoring**: ‡∏î‡∏π‡∏ú‡∏•‡∏Å‡∏£‡∏∞‡∏ó‡∏ö‡∏Ç‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ CPU ‡πÅ‡∏•‡∏∞ memory ‡πÅ‡∏ö‡∏ö real-time
- **Distributed Tracing**: ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡πÇ‡∏¢‡∏á request ‡∏Ç‡πâ‡∏≤‡∏°‡∏Ç‡∏≠‡∏ö‡πÄ‡∏Ç‡∏ï‡∏Ç‡∏≠‡∏á service ‡∏ï‡πà‡∏≤‡∏á‡πÜ

## ‡∏™‡∏ñ‡∏≤‡∏õ‡∏±‡∏ï‡∏¢‡∏Å‡∏£‡∏£‡∏° üèóÔ∏è

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê         ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê         ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ   Client    ‚îÇ ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ> ‚îÇ Upstream API‚îÇ ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ> ‚îÇ Downstream API   ‚îÇ
‚îÇ  (‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤)    ‚îÇ         ‚îÇ  (Port 5000)‚îÇ         ‚îÇ   (Port 5001)    ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò         ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò         ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                               ‚îÇ                          ‚îÇ
                               ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                                          ‚îÇ
                                 ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
                                 ‚îÇ Azure Application‚îÇ
                                 ‚îÇ    Insights      ‚îÇ
                                 ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

## ‡∏™‡∏¥‡πà‡∏á‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏° üìã

### ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Local Development
- [.NET 8 SDK](https://dotnet.microsoft.com/download/dotnet/8.0) - ‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á‡πÉ‡∏´‡πâ‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡∏ô‡∏∞‡∏Ñ‡∏£‡∏±‡∏ö
- Visual Studio 2022 ‡∏´‡∏£‡∏∑‡∏≠ VS Code (‡∏ñ‡πâ‡∏≤‡∏ä‡∏≠‡∏ö)

### ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Azure Deployment
- Azure subscription (‡∏ï‡πâ‡∏≠‡∏á‡∏°‡∏µ‡∏ô‡∏∞ ‡πÑ‡∏°‡πà‡∏á‡∏±‡πâ‡∏ô‡πÄ‡∏•‡πà‡∏ô‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ)
- [Azure CLI](https://docs.microsoft.com/en-us/cli/azure/install-azure-cli) ‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á‡∏ã‡∏∞
- Azure Application Insights resource
- Azure App Service ‡∏´‡∏£‡∏∑‡∏≠ Azure Container Apps

## ‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏î‡πà‡∏ß‡∏ô ‚ö°

1. **Clone repository ‡∏°‡∏≤‡∏Å‡πà‡∏≠‡∏ô**
   ```powershell
   git clone <repository-url>
   cd observability-simple
   ```

2. **Build solution ‡∏ã‡∏∞‡∏´‡∏ô‡πà‡∏≠‡∏¢**
   ```powershell
   dotnet build
   ```

3. **‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ Azure** (‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö deploy ‡∏Ç‡∏∂‡πâ‡∏ô Azure)
   
   ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á Azure CLI ‡πÅ‡∏•‡πâ‡∏ß ‡πÅ‡∏•‡∏∞ login ‡πÄ‡∏Ç‡πâ‡∏≤‡∏£‡∏∞‡∏ö‡∏ö:
   ```powershell
   # ‡πÄ‡∏ä‡πá‡∏Ñ‡∏ß‡πà‡∏≤‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á Azure CLI ‡∏´‡∏£‡∏∑‡∏≠‡∏¢‡∏±‡∏á
   az --version
   
   # ‡∏ñ‡πâ‡∏≤‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á ‡πÑ‡∏õ‡πÇ‡∏´‡∏•‡∏î‡∏°‡∏≤‡∏à‡∏≤‡∏Å: https://aka.ms/installazurecliwindows
   
   # Login ‡πÄ‡∏Ç‡πâ‡∏≤ Azure
   az login
   ```
   
   ‡∏°‡∏±‡∏ô‡∏à‡∏∞‡πÄ‡∏õ‡∏¥‡∏î browser ‡πÉ‡∏´‡πâ‡πÉ‡∏™‡πà‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô ‡∏û‡∏≠ login ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à‡πÅ‡∏•‡πâ‡∏ß:
   ```powershell
   # ‡πÄ‡∏ä‡πá‡∏Ñ‡∏î‡∏π‡∏ß‡πà‡∏≤ login ‡πÑ‡∏î‡πâ‡∏à‡∏£‡∏¥‡∏á‡πÑ‡∏´‡∏° ‡πÅ‡∏•‡∏∞‡∏î‡∏π subscription
   az account show
   
   # ‡∏ñ‡πâ‡∏≤‡∏°‡∏µ‡∏´‡∏•‡∏≤‡∏¢ subscription ‡∏Å‡πá list ‡∏î‡∏π‡∏´‡∏ô‡πà‡∏≠‡∏¢
   az account list --output table
   
   # ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å subscription ‡∏ó‡∏µ‡πà‡∏à‡∏∞‡πÉ‡∏ä‡πâ (‡∏ñ‡πâ‡∏≤‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£)
   az account set --subscription "‡∏ä‡∏∑‡πà‡∏≠‡∏´‡∏£‡∏∑‡∏≠-id-subscription-‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì"
   ```

4. **Deploy ‡∏Ç‡∏∂‡πâ‡∏ô Azure** (‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡∏ß‡∏¥‡∏ò‡∏µ‡∏ô‡∏µ‡πâ‡πÄ‡∏•‡∏¢!)
   
   ‡πÉ‡∏ä‡πâ PowerShell script ‡∏£‡∏±‡∏ô‡∏á‡πà‡∏≤‡∏¢‡πÜ:
   ```powershell
   # ‡∏™‡∏£‡πâ‡∏≤‡∏á Azure resources ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î (‡∏ó‡∏≥‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡πÄ‡∏î‡∏µ‡∏¢‡∏ß)
   .\create-azure-resources.ps1
   
   # Deploy ‡πÅ‡∏≠‡∏û‡∏û‡∏•‡∏¥‡πÄ‡∏Ñ‡∏ä‡∏±‡πà‡∏ô
   .\deploy-apps-only.ps1
   ```
   
   Script ‡∏à‡∏∞‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£ Application Insights ‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡πÉ‡∏´‡πâ‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥‡πÄ‡∏•‡∏¢!
   
   ‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó `appsettings.json` ‡∏Ç‡∏≠‡∏á‡∏ó‡∏±‡πâ‡∏á‡∏™‡∏≠‡∏á API:
   ```json
   "ApplicationInsights": {
     "ConnectionString": "InstrumentationKey=KEY_‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì;IngestionEndpoint=https://eastus-8.in.applicationinsights.azure.com/;LiveEndpoint=https://eastus.livediagnostics.monitor.azure.com/"
   }
   ```

5. **‡∏£‡∏±‡∏ô‡πÉ‡∏ô Local** (‡∏ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡∏≠‡∏¢‡∏≤‡∏Å deploy)
   
   ‡∏£‡∏±‡∏ô‡∏ó‡∏±‡πâ‡∏á‡∏™‡∏≠‡∏á API ‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏Å‡∏±‡∏ô:
   ```powershell
   # ‡πÄ‡∏õ‡∏¥‡∏î PowerShell ‡∏´‡∏ô‡πâ‡∏≤‡∏ï‡πà‡∏≤‡∏á‡πÅ‡∏£‡∏Å - ‡∏£‡∏±‡∏ô downstream API
   cd downstream-api/DownstreamApi
   dotnet run
   # API ‡∏à‡∏∞‡∏£‡∏±‡∏ô‡∏ó‡∏µ‡πà http://localhost:5001
   
   # ‡πÄ‡∏õ‡∏¥‡∏î PowerShell ‡∏´‡∏ô‡πâ‡∏≤‡∏ï‡πà‡∏≤‡∏á‡∏ó‡∏µ‡πà‡∏™‡∏≠‡∏á - ‡∏£‡∏±‡∏ô upstream API
   cd upstream-api/UpstreamApi  
   dotnet run
   # API ‡∏à‡∏∞‡∏£‡∏±‡∏ô‡∏ó‡∏µ‡πà http://localhost:5000
   ```

6. **‡πÄ‡∏Ç‡πâ‡∏≤‡∏î‡∏π Swagger UI ‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏¢**
   - Local Downstream API: http://localhost:5001/swagger
   - Local Upstream API: http://localhost:5000/swagger
   - Azure Upstream API: https://app-‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì.azurewebsites.net/swagger

## API Endpoints ‡∏ó‡∏µ‡πà‡∏°‡∏µ‡πÉ‡∏´‡πâ‡πÄ‡∏•‡πà‡∏ô üéÆ

### Downstream API (Port 5001)

| Endpoint | Method | ‡∏Ñ‡∏≥‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢ | Parameters |
|----------|--------|----------|------------|
| `/products/{id}` | GET | ‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤ ‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ä‡πâ‡∏≤‡∏ó‡∏µ‡πà‡∏õ‡∏£‡∏±‡∏ö‡πÑ‡∏î‡πâ | `id` (path), `delayMs` (query, ‡πÑ‡∏°‡πà‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö) |
| `/orders` | POST | ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠ ‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏à‡∏≥‡∏•‡∏≠‡∏á‡∏Ñ‡∏ß‡∏≤‡∏°‡∏•‡πâ‡∏°‡πÄ‡∏´‡∏•‡∏ß | `failureMode` (query: none/transient/persistent) |
| `/pressure/cpu` | GET | ‡∏à‡∏≥‡∏•‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏´‡∏ô‡∏±‡∏Å‡∏Ç‡∏≠‡∏á CPU | `iterations` (query, ‡πÑ‡∏°‡πà‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö) |
| `/pressure/memory` | GET | ‡∏à‡∏≥‡∏•‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ memory | `mbToAllocate` (query, ‡πÑ‡∏°‡πà‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö) |

### Upstream API (Port 5000)

| Endpoint | Method | ‡∏Ñ‡∏≥‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢ | Parameters |
|----------|--------|----------|------------|
| `/gateway/products/{id}` | GET | Gateway ‡πÑ‡∏õ‡∏¢‡∏±‡∏á downstream products | `id` (path), `delayMs` (query, ‡πÑ‡∏°‡πà‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö) |
| `/gateway/orders` | POST | Gateway ‡πÑ‡∏õ‡∏¢‡∏±‡∏á downstream orders | `failureMode` (query, ‡πÑ‡∏°‡πà‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö) |

## ‡∏™‡∏ñ‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡∏ì‡πå‡∏ó‡∏î‡∏™‡∏≠‡∏ö üß™

### 1. ‡∏à‡∏≥‡∏•‡∏≠‡∏á‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ä‡πâ‡∏≤ (Latency Simulation)
‡∏ó‡∏î‡∏™‡∏≠‡∏ö response time ‡∏ó‡∏µ‡πà‡∏ä‡πâ‡∏≤:
```powershell
# Response ‡∏õ‡∏Å‡∏ï‡∏¥
Invoke-RestMethod http://localhost:5001/products/123

# ‡∏ä‡πâ‡∏≤ 2 ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ
Invoke-RestMethod "http://localhost:5001/products/123?delayMs=2000"

# ‡∏ú‡πà‡∏≤‡∏ô gateway ‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ä‡πâ‡∏≤
Invoke-RestMethod "http://localhost:5000/gateway/products/456?delayMs=1500"
```

### 2. ‡∏à‡∏≥‡∏•‡∏≠‡∏á‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î (Error Simulation)
‡∏ó‡∏î‡∏™‡∏≠‡∏ö failure modes ‡∏ï‡πà‡∏≤‡∏á‡πÜ:
```powershell
# ‡∏™‡∏ñ‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡∏ì‡πå‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à
Invoke-RestMethod -Uri http://localhost:5001/orders -Method Post

# ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏•‡πâ‡∏°‡πÄ‡∏´‡∏•‡∏ß‡∏ä‡∏±‡πà‡∏ß‡∏Ñ‡∏£‡∏≤‡∏ß (‡πÇ‡∏≠‡∏Å‡∏≤‡∏™ 50%)
Invoke-RestMethod -Uri "http://localhost:5001/orders?failureMode=transient" -Method Post

# ‡∏•‡πâ‡∏°‡πÄ‡∏´‡∏•‡∏ß‡∏ï‡∏•‡∏≠‡∏î (100% ‡∏û‡∏±‡∏á)
Invoke-RestMethod -Uri "http://localhost:5001/orders?failureMode=persistent" -Method Post

# ‡∏ú‡πà‡∏≤‡∏ô gateway
Invoke-RestMethod -Uri "http://localhost:5000/gateway/orders?failureMode=transient" -Method Post
```

### 3. ‡∏Å‡∏î‡∏î‡∏±‡∏ô CPU
‡∏à‡∏≥‡∏•‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ CPU ‡∏™‡∏π‡∏á:
```powershell
# ‡πÇ‡∏´‡∏•‡∏î‡πÄ‡∏ö‡∏≤‡πÜ
Invoke-RestMethod "http://localhost:5001/pressure/cpu?iterations=100000"

# ‡πÇ‡∏´‡∏•‡∏î‡∏´‡∏ô‡∏±‡∏Å‡∏°‡∏≤‡∏Å
Invoke-RestMethod "http://localhost:5001/pressure/cpu?iterations=10000000"
```

### 4. ‡∏Å‡∏î‡∏î‡∏±‡∏ô Memory
‡∏à‡∏≥‡∏•‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏à‡∏≠‡∏á memory:
```powershell
# ‡∏à‡∏≠‡∏á 50MB
Invoke-RestMethod "http://localhost:5001/pressure/memory?mbToAllocate=50"

# ‡∏à‡∏≠‡∏á 200MB
Invoke-RestMethod "http://localhost:5001/pressure/memory?mbToAllocate=200"
```

![Postman ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å API ‡∏ó‡∏î‡∏™‡∏≠‡∏ö CPU ‡πÅ‡∏•‡∏∞ Memory](./documents/postman_call_api_consume_ram_cpu.png)
*‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ Postman ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å API ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô CPU ‡πÅ‡∏•‡∏∞ Memory*

## ‡∏ü‡∏µ‡πÄ‡∏à‡∏≠‡∏£‡πå Observability üìä

### Structured Logging
‡∏ó‡∏∏‡∏Å endpoint ‡πÉ‡∏ä‡πâ structured logging ‡∏û‡∏£‡πâ‡∏≠‡∏° key-value pairs:
- Product operations log: `ProductId`, `DelayMs`
- Order operations log: `FailureMode`, `OrderId`
- CPU pressure logs: `Iterations`, `Duration`
- Memory pressure logs: `MbToAllocate`

### Distributed Tracing
‡∏£‡∏∞‡∏ö‡∏ö‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö distributed tracing ‡∏ú‡πà‡∏≤‡∏ô:
- ‡∏Å‡∏≤‡∏£‡∏™‡πà‡∏á‡∏ï‡πà‡∏≠ correlation ID ‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á Upstream ‡πÅ‡∏•‡∏∞ Downstream APIs
- ‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏° request ‡∏Ç‡πâ‡∏≤‡∏°‡∏Ç‡∏≠‡∏ö‡πÄ‡∏Ç‡∏ï service
- ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡πÇ‡∏¢‡∏á error ‡∏à‡∏≤‡∏Å gateway ‡πÑ‡∏õ‡∏¢‡∏±‡∏á backend services

### ‡∏Å‡∏≤‡∏£‡∏£‡∏ß‡∏°‡∏Å‡∏±‡∏ö Application Insights
‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ Azure Application Insights ‡πÅ‡∏•‡πâ‡∏ß ‡∏Ñ‡∏∏‡∏ì‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ:
- ‡∏î‡∏π‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î transaction ‡πÅ‡∏ö‡∏ö end-to-end
- ‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå performance metrics ‡πÅ‡∏•‡∏∞‡∏´‡∏≤ bottlenecks
- ‡∏ï‡∏±‡πâ‡∏á alerts ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏•‡πâ‡∏°‡πÄ‡∏´‡∏•‡∏ß‡πÅ‡∏•‡∏∞ performance ‡∏ó‡∏µ‡πà‡πÅ‡∏¢‡πà‡∏•‡∏á
- ‡∏™‡∏£‡πâ‡∏≤‡∏á custom dashboards ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö monitoring

## ‡πÅ‡∏ö‡∏ö‡∏ù‡∏∂‡∏Å‡∏´‡∏±‡∏î‡∏Å‡∏≤‡∏£‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏£‡∏π‡πâ üìö

### ‡πÅ‡∏ö‡∏ö‡∏ù‡∏∂‡∏Å‡∏´‡∏±‡∏î‡∏û‡∏∑‡πâ‡∏ô‡∏ê‡∏≤‡∏ô

#### ‡πÅ‡∏ö‡∏ö‡∏ù‡∏∂‡∏Å‡∏´‡∏±‡∏î 1: ‡∏´‡∏≤‡∏ï‡πâ‡∏ô‡∏ï‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ä‡πâ‡∏≤
1. ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å `/gateway/products/100?delayMs=3000`
2. ‡πÉ‡∏ä‡πâ Application Insights ‡∏´‡∏≤‡∏ß‡πà‡∏≤‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ä‡πâ‡∏≤‡πÄ‡∏Å‡∏¥‡∏î‡∏ó‡∏µ‡πà‡πÑ‡∏´‡∏ô
3. ‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏ß‡πà‡∏≤‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ä‡πâ‡∏≤‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô downstream service

#### ‡πÅ‡∏ö‡∏ö‡∏ù‡∏∂‡∏Å‡∏´‡∏±‡∏î 2: ‡∏ï‡∏≤‡∏°‡∏£‡∏≠‡∏¢‡∏Ñ‡∏ß‡∏≤‡∏°‡∏•‡πâ‡∏°‡πÄ‡∏´‡∏•‡∏ß‡∏ä‡∏±‡πà‡∏ß‡∏Ñ‡∏£‡∏≤‡∏ß
1. ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å `/gateway/orders?failureMode=transient` ‡∏´‡∏•‡∏≤‡∏¢‡πÜ ‡∏Ñ‡∏£‡∏±‡πâ‡∏á
2. ‡∏™‡∏±‡∏á‡πÄ‡∏Å‡∏ï‡∏≠‡∏±‡∏ï‡∏£‡∏≤‡∏Ñ‡∏ß‡∏≤‡∏°‡∏•‡πâ‡∏°‡πÄ‡∏´‡∏•‡∏ß 50%
3. ‡∏ï‡∏≤‡∏°‡∏£‡∏≠‡∏¢ request ‡∏ó‡∏µ‡πà‡∏•‡πâ‡∏°‡πÄ‡∏´‡∏•‡∏ß‡∏ú‡πà‡∏≤‡∏ô‡∏ó‡∏±‡πâ‡∏á‡∏™‡∏≠‡∏á service
4. ‡∏£‡∏∞‡∏ö‡∏∏‡∏à‡∏∏‡∏î‡∏ó‡∏µ‡πà‡∏•‡πâ‡∏°‡πÄ‡∏´‡∏•‡∏ß‡πÅ‡∏•‡∏∞‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î error

#### ‡πÅ‡∏ö‡∏ö‡∏ù‡∏∂‡∏Å‡∏´‡∏±‡∏î 3: Monitor ‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏ó‡∏£‡∏±‡∏û‡∏¢‡∏≤‡∏Å‡∏£
1. ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÅ‡∏£‡∏á‡∏î‡∏±‡∏ô CPU: `/pressure/cpu?iterations=50000000`
2. ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÅ‡∏£‡∏á‡∏î‡∏±‡∏ô memory: `/pressure/memory?mbToAllocate=500`
3. ‡∏î‡∏π‡∏ú‡∏•‡∏Å‡∏£‡∏∞‡∏ó‡∏ö‡∏ï‡πà‡∏≠ performance ‡∏Ç‡∏≠‡∏á service
4. ‡∏ï‡∏±‡πâ‡∏á alerts ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏ó‡∏£‡∏±‡∏û‡∏¢‡∏≤‡∏Å‡∏£‡∏™‡∏π‡∏á

#### ‡πÅ‡∏ö‡∏ö‡∏ù‡∏∂‡∏Å‡∏´‡∏±‡∏î 4: ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡πÇ‡∏¢‡∏á Distributed Errors
1. ‡∏´‡∏¢‡∏∏‡∏î Downstream API
2. ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å gateway endpoints
3. ‡∏™‡∏±‡∏á‡πÄ‡∏Å‡∏ï 502 Bad Gateway errors
4. ‡∏ï‡∏≤‡∏°‡∏£‡∏≠‡∏¢‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏±‡∏°‡∏û‡∏±‡∏ô‡∏ò‡πå‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á gateway errors ‡πÅ‡∏•‡∏∞ downstream ‡∏ó‡∏µ‡πà‡πÑ‡∏°‡πà‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô

### ‡πÅ‡∏ö‡∏ö‡∏ù‡∏∂‡∏Å‡∏´‡∏±‡∏î‡∏Ç‡∏±‡πâ‡∏ô‡∏™‡∏π‡∏á üîç

**[‡∏î‡∏π‡πÅ‡∏ö‡∏ö‡∏ù‡∏∂‡∏Å‡∏´‡∏±‡∏î Observability ‡∏Ç‡∏±‡πâ‡∏ô‡∏™‡∏π‡∏á](./ADVANCED-EXERCISES.md)**

‡πÅ‡∏ö‡∏ö‡∏ù‡∏∂‡∏Å‡∏´‡∏±‡∏î‡∏Ç‡∏±‡πâ‡∏ô‡∏™‡∏π‡∏á‡∏°‡∏µ bug ‡πÅ‡∏ö‡∏ö production ‡∏à‡∏£‡∏¥‡∏á‡πÜ ‡∏ó‡∏µ‡πà‡∏ã‡πà‡∏≠‡∏ô‡∏≠‡∏¢‡∏π‡πà ‡∏ï‡πâ‡∏≠‡∏á‡πÉ‡∏ä‡πâ‡∏ó‡∏±‡∏Å‡∏©‡∏∞‡∏ô‡∏±‡∏Å‡∏™‡∏∑‡∏ö‡∏´‡∏≤‡πÉ‡∏´‡πâ‡πÄ‡∏à‡∏≠:
- **‡∏õ‡∏£‡∏¥‡∏®‡∏ô‡∏≤‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏ä‡πâ‡∏≤‡∏•‡∏∂‡∏Å‡∏•‡∏±‡∏ö** - ‡∏ö‡∏≤‡∏á‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡πÇ‡∏´‡∏•‡∏î‡∏ä‡πâ‡∏≤‡∏°‡∏≤‡∏Å 3+ ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ‡πÄ‡∏•‡∏¢!
- **‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ú‡∏¥‡∏î‡∏õ‡∏Å‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡∏°‡∏ß‡∏•‡∏ú‡∏•‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠** - ‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠‡∏ö‡∏≤‡∏á‡∏ä‡πà‡∏ß‡∏á‡∏•‡πâ‡∏°‡πÄ‡∏´‡∏•‡∏ß 90%
- **‡∏õ‡∏£‡∏¥‡∏®‡∏ô‡∏≤ Memory Leak** - ‡∏ö‡∏≤‡∏á request ‡∏ó‡∏≥‡πÉ‡∏´‡πâ memory ‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏Ñ‡∏∑‡∏ô
- **‡∏õ‡∏±‡∏ç‡∏´‡∏≤ Performance ‡πÄ‡∏õ‡πá‡∏ô‡∏£‡∏≠‡∏ö** - ‡∏ó‡∏∏‡∏Å‡πÜ ‡∏™‡∏≠‡∏á-‡∏™‡∏≤‡∏° request ‡∏à‡∏∞‡∏Ñ‡πâ‡∏≤‡∏á‡πÑ‡∏õ 5 ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ
- **‡∏´‡∏≤‡∏¢‡∏ô‡∏∞ Cache ‡πÄ‡∏™‡∏µ‡∏¢‡∏´‡∏≤‡∏¢** - input ‡∏ú‡∏¥‡∏î‡πÜ ‡∏ó‡∏≥‡πÉ‡∏´‡πâ response ‡∏´‡∏•‡∏±‡∏á‡∏à‡∏≤‡∏Å‡∏ô‡∏±‡πâ‡∏ô‡∏û‡∏±‡∏á‡∏´‡∏°‡∏î
- **‡∏≠‡∏≤‡∏Å‡∏≤‡∏£ CPU ‡∏û‡∏∏‡πà‡∏á‡∏™‡∏π‡∏á** - ID ‡πÅ‡∏ö‡∏ö palindrome ‡∏ó‡∏≥‡πÉ‡∏´‡πâ CPU ‡∏û‡∏∏‡πà‡∏á‡∏™‡∏∏‡∏î‡πÜ

‡πÉ‡∏ä‡πâ test data generator ‡πÅ‡∏ö‡∏ö cross-platform ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Å‡∏£‡∏∞‡∏ï‡∏∏‡πâ‡∏ô bug:
```powershell
# Build test data generator
cd test-data-generator
dotnet build

# ‡∏£‡∏±‡∏ô‡∏ó‡∏∏‡∏Å‡∏Å‡∏≤‡∏£‡∏ó‡∏î‡∏™‡∏≠‡∏ö
dotnet run -- http://localhost:5000 all

# ‡∏£‡∏±‡∏ô‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó (random, range, prime, load, palindrome, edge)
dotnet run -- http://localhost:5000 palindrome
```

![Console App Test Data Generator](./documents/console_app_generate_advance_exercise_test_data.png)
*Console application ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏™‡∏£‡πâ‡∏≤‡∏á test data ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ó‡∏î‡∏™‡∏≠‡∏ö advanced exercises*

## ‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ ‚öôÔ∏è

### Application Settings
‡∏ó‡∏±‡πâ‡∏á‡∏™‡∏≠‡∏á API ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏ú‡πà‡∏≤‡∏ô `appsettings.json`:

**Downstream API:**
```json
{
  "ApplicationInsights": {
    "ConnectionString": "CONNECTION_STRING_‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì"
  },
  "Kestrel": {
    "Endpoints": {
      "Http": {
        "Url": "http://localhost:5001"
      }
    }
  }
}
```

**Upstream API:**
```json
{
  "ApplicationInsights": {
    "ConnectionString": "CONNECTION_STRING_‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì"
  },
  "DownstreamApi": {
    "BaseUrl": "http://localhost:5001"
  },
  "Kestrel": {
    "Endpoints": {
      "Http": {
        "Url": "http://localhost:5000"
      }
    }
  }
}
```

## ‡πÅ‡∏Å‡πâ‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡πÄ‡∏ö‡∏∑‡πâ‡∏≠‡∏á‡∏ï‡πâ‡∏ô üîß

### APIs ‡πÑ‡∏°‡πà‡∏¢‡∏≠‡∏° start
- ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤ port 5000 ‡πÅ‡∏•‡∏∞ 5001 ‡πÑ‡∏°‡πà‡∏°‡∏µ‡πÉ‡∏Ñ‡∏£‡πÉ‡∏ä‡πâ‡∏≠‡∏¢‡∏π‡πà
- ‡πÄ‡∏ä‡πá‡∏Ñ‡∏ß‡πà‡∏≤‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á .NET 8 SDK ‡πÅ‡∏•‡πâ‡∏ß: `dotnet --version`

### Connection refused ‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á services
- ‡∏ï‡πâ‡∏≠‡∏á‡∏£‡∏±‡∏ô Downstream API ‡∏Å‡πà‡∏≠‡∏ô‡∏ó‡∏î‡∏™‡∏≠‡∏ö Upstream API
- ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö `DownstreamApi:BaseUrl` ‡πÉ‡∏ô Upstream API configuration

### ‡πÑ‡∏°‡πà‡πÄ‡∏´‡πá‡∏ô telemetry ‡πÉ‡∏ô Application Insights
- ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤ connection string ‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á
- ‡πÄ‡∏ä‡πá‡∏Ñ‡∏ß‡πà‡∏≤ Application Insights resource ‡∏¢‡∏±‡∏á‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏≠‡∏¢‡∏π‡πà
- ‡∏£‡∏≠‡∏™‡∏±‡∏Å‡∏™‡∏≠‡∏á‡∏™‡∏≤‡∏°‡∏ô‡∏≤‡∏ó‡∏µ‡πÉ‡∏´‡πâ telemetry ‡∏Ç‡∏∂‡πâ‡∏ô‡∏°‡∏≤

## ‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á Project üìÅ

```
observability-simple/
‚îú‚îÄ‚îÄ downstream-api/
‚îÇ   ‚îî‚îÄ‚îÄ DownstreamApi/
‚îÇ       ‚îú‚îÄ‚îÄ Program.cs          # Endpoints ‡πÅ‡∏•‡∏∞ configuration ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
‚îÇ       ‚îú‚îÄ‚îÄ appsettings.json    # Configuration
‚îÇ       ‚îî‚îÄ‚îÄ DownstreamApi.csproj
‚îú‚îÄ‚îÄ upstream-api/
‚îÇ   ‚îî‚îÄ‚îÄ UpstreamApi/
‚îÇ       ‚îú‚îÄ‚îÄ Program.cs          # Gateway endpoints
‚îÇ       ‚îú‚îÄ‚îÄ appsettings.json    # Configuration
‚îÇ       ‚îî‚îÄ‚îÄ UpstreamApi.csproj
‚îú‚îÄ‚îÄ test-data-generator/
‚îÇ   ‚îú‚îÄ‚îÄ Program.cs              # Test data generator ‡πÅ‡∏ö‡∏ö cross-platform
‚îÇ   ‚îî‚îÄ‚îÄ TestDataGenerator.csproj
‚îú‚îÄ‚îÄ tests/
‚îÇ   ‚îú‚îÄ‚îÄ ObservabilityTests/    # Shared test utilities
‚îÇ   ‚îî‚îÄ‚îÄ DownstreamApiTests/    # Downstream API unit tests
‚îú‚îÄ‚îÄ create-azure-resources.ps1  # Script ‡∏™‡∏£‡πâ‡∏≤‡∏á Azure resources
‚îú‚îÄ‚îÄ deploy-apps-only.ps1        # Script deploy applications
‚îú‚îÄ‚îÄ ObservabilitySimple.sln     # Solution file
‚îú‚îÄ‚îÄ CLAUDE.md                   # ‡πÅ‡∏ú‡∏ô‡∏Å‡∏≤‡∏£ implementation
‚îú‚îÄ‚îÄ README.md                   # ‡πÑ‡∏ü‡∏•‡πå‡∏ï‡πâ‡∏ô‡∏â‡∏ö‡∏±‡∏ö‡∏†‡∏≤‡∏©‡∏≤‡∏≠‡∏±‡∏á‡∏Å‡∏§‡∏©
‚îú‚îÄ‚îÄ README_TH.md                # ‡πÑ‡∏ü‡∏•‡πå‡∏ô‡∏µ‡πâ (‡∏†‡∏≤‡∏©‡∏≤‡πÑ‡∏ó‡∏¢)
‚îú‚îÄ‚îÄ ADVANCED-EXERCISES.md       # ‡πÅ‡∏ö‡∏ö‡∏ù‡∏∂‡∏Å‡∏´‡∏±‡∏î‡∏•‡πà‡∏≤ bug ‡∏Ç‡∏±‡πâ‡∏ô‡∏™‡∏π‡∏á
‚îî‚îÄ‚îÄ ADVANCED-EXERCISES_TH.md    # ‡πÅ‡∏ö‡∏ö‡∏ù‡∏∂‡∏Å‡∏´‡∏±‡∏î‡∏Ç‡∏±‡πâ‡∏ô‡∏™‡∏π‡∏á‡∏†‡∏≤‡∏©‡∏≤‡πÑ‡∏ó‡∏¢
```

## ‡∏Å‡∏≤‡∏£ Deploy ‡∏Ç‡∏∂‡πâ‡∏ô Azure ‚òÅÔ∏è

### PowerShell Deployment Scripts

**‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏ó‡∏µ‡πà 1: ‡∏™‡∏£‡πâ‡∏≤‡∏á Azure Resources (‡∏ó‡∏≥‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡πÄ‡∏î‡∏µ‡∏¢‡∏ß)**
‡∏™‡∏£‡πâ‡∏≤‡∏á Azure resources ‡∏ó‡∏µ‡πà‡∏à‡∏≥‡πÄ‡∏õ‡πá‡∏ô‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î:

```powershell
# ‡∏™‡∏£‡πâ‡∏≤‡∏á Azure resources ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î (Resource Group, App Service Plan, Web Apps, Application Insights)
.\create-azure-resources.ps1

# ‡∏´‡∏£‡∏∑‡∏≠‡πÉ‡∏ä‡πâ parameters ‡∏ó‡∏µ‡πà‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡πÄ‡∏≠‡∏á
.\create-azure-resources.ps1 -ResourceGroup "my-rg" -Location "eastus" -DownstreamAppName "my-downstream" -UpstreamAppName "my-upstream"
```

**‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏ó‡∏µ‡πà 2: Deploy Applications (‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó)**
Deploy code ‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î‡πÑ‡∏õ‡∏¢‡∏±‡∏á Azure resources ‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏≠‡∏¢‡∏π‡πà:

```powershell
# Deploy apps ‡πÑ‡∏õ‡∏¢‡∏±‡∏á resources ‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏≠‡∏¢‡∏π‡πà
.\deploy-apps-only.ps1

# ‡∏´‡∏£‡∏∑‡∏≠‡πÉ‡∏ä‡πâ parameters ‡∏ó‡∏µ‡πà‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡πÄ‡∏≠‡∏á
.\deploy-apps-only.ps1 -ResourceGroup "observability-rg-west" -DownstreamApp "observability-downstream" -UpstreamApp "observability-upstream"
```

**Workflow ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î:**
```powershell
# 1. ‡∏™‡∏£‡πâ‡∏≤‡∏á resources (‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡πÄ‡∏î‡∏µ‡∏¢‡∏ß)
.\create-azure-resources.ps1

# 2. Deploy applications
.\deploy-apps-only.ps1

# 3. ‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏Å‡∏±‡∏ö bug ‡∏Ç‡∏±‡πâ‡∏ô‡∏™‡∏π‡∏á
cd test-data-generator
dotnet run -- https://observability-upstream.azurewebsites.net all
```

### ‡∏Å‡∏≤‡∏£ Deploy Azure App Service ‡πÅ‡∏ö‡∏ö Manual

‡∏ñ‡πâ‡∏≤‡∏≠‡∏¢‡∏≤‡∏Å deploy ‡πÄ‡∏≠‡∏á‡πÅ‡∏ö‡∏ö manual ‡∏ó‡∏≥‡∏ï‡∏≤‡∏° PowerShell steps ‡∏ô‡∏µ‡πâ:

#### ‡∏™‡∏¥‡πà‡∏á‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏°‡∏µ
- Azure CLI ‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á‡πÅ‡∏•‡∏∞ login ‡πÅ‡∏•‡πâ‡∏ß (`az login`)
- PowerShell 5.1 ‡∏´‡∏£‡∏∑‡∏≠ PowerShell Core 7+
- ‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå Azure subscription ‡∏ó‡∏µ‡πà‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏™‡∏°

#### ‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏Å‡∏≤‡∏£ Deploy ‡∏ó‡∏µ‡∏•‡∏∞‡∏Ç‡∏±‡πâ‡∏ô

1. **‡∏™‡∏£‡πâ‡∏≤‡∏á Resource Group ‡πÅ‡∏•‡∏∞ Application Insights**
   ```powershell
   # ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å region ‡∏ó‡∏µ‡πà subscription ‡∏Ñ‡∏∏‡∏ì‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö
   # ‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ: westus2, eastus2, centralus, westeurope
   az group create --name observability-rg-west --location westus2
   
   # ‡∏™‡∏£‡πâ‡∏≤‡∏á Application Insights
   az monitor app-insights component create `
     --app observability-insights `
     --location westus2 `
     --resource-group observability-rg-west `
     --application-type web
   ```

2. **‡∏™‡∏£‡πâ‡∏≤‡∏á App Service Plan**
   ```powershell
   # ‡∏•‡∏≠‡∏á F1 (Free) tier ‡∏Å‡πà‡∏≠‡∏ô ‡∏ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏Ñ‡πà‡∏≠‡∏¢‡πÉ‡∏ä‡πâ B1
   az appservice plan create `
     --name observability-plan `
     --resource-group observability-rg-west `
     --location westus2 `
     --sku F1
   
   # ‡∏ñ‡πâ‡∏≤ F1 ‡πÑ‡∏°‡πà‡∏û‡∏≠ (quota ‡πÄ‡∏ï‡πá‡∏°) ‡∏•‡∏≠‡∏á‡πÉ‡∏ä‡πâ B1 (‡∏ï‡πâ‡∏≠‡∏á‡∏°‡∏µ compute quota)
   # az appservice plan create `
   #   --name observability-plan `
   #   --resource-group observability-rg-west `
   #   --location westus2 `
   #   --sku B1
   ```

3. **‡∏™‡∏£‡πâ‡∏≤‡∏á Web Apps**
   ```powershell
   # ‡∏™‡∏£‡πâ‡∏≤‡∏á downstream API app
   az webapp create `
     --name observability-downstream `
     --resource-group observability-rg-west `
     --plan observability-plan `
     --runtime "dotnet:8"
   
   # ‡∏™‡∏£‡πâ‡∏≤‡∏á upstream API app
   az webapp create `
     --name observability-upstream `
     --resource-group observability-rg-west `
     --plan observability-plan `
     --runtime "dotnet:8"
   ```

4. **‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ Application Settings**
   ```powershell
   # ‡∏î‡∏∂‡∏á Application Insights connection string
   $connectionString = az monitor app-insights component show `
     --app observability-insights `
     --resource-group observability-rg-west `
     --query connectionString -o tsv
   
   # ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ Downstream API
   az webapp config appsettings set `
     --name observability-downstream `
     --resource-group observability-rg-west `
     --settings "APPLICATIONINSIGHTS_CONNECTION_STRING=$connectionString"
   
   # ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ Upstream API ‡∏û‡∏£‡πâ‡∏≠‡∏° downstream URL
   az webapp config appsettings set `
     --name observability-upstream `
     --resource-group observability-rg-west `
     --settings "APPLICATIONINSIGHTS_CONNECTION_STRING=$connectionString" `
                "DownstreamApi__BaseUrl=https://observability-downstream.azurewebsites.net"
   ```

5. **Build ‡πÅ‡∏•‡∏∞ Deploy Applications**
   ```powershell
   # Build downstream API
   dotnet publish downstream-api/DownstreamApi/DownstreamApi.csproj `
     --configuration Release `
     --output ./publish/downstream
   
   # Build upstream API  
   dotnet publish upstream-api/UpstreamApi/UpstreamApi.csproj `
     --configuration Release `
     --output ./publish/upstream
   
   # ‡∏™‡∏£‡πâ‡∏≤‡∏á deployment packages
   Compress-Archive -Path 'publish/downstream/*' -DestinationPath 'publish/downstream-api.zip' -Force
   Compress-Archive -Path 'publish/upstream/*' -DestinationPath 'publish/upstream-api.zip' -Force
   
   # Deploy ‡∏Ç‡∏∂‡πâ‡∏ô Azure
   az webapp deploy `
     --name observability-downstream `
     --resource-group observability-rg-west `
     --src-path publish/downstream-api.zip `
     --type zip
   
   az webapp deploy `
     --name observability-upstream `
     --resource-group observability-rg-west `
     --src-path publish/upstream-api.zip `
     --type zip
   ```

6. **‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£ Deploy**
   ```powershell
   # ‡∏ó‡∏î‡∏™‡∏≠‡∏ö health endpoints
   Invoke-RestMethod https://observability-downstream.azurewebsites.net/health
   Invoke-RestMethod https://observability-upstream.azurewebsites.net/health
   
   # ‡∏ó‡∏î‡∏™‡∏≠‡∏ö application endpoints
   Invoke-RestMethod "https://observability-upstream.azurewebsites.net/gateway/products/123?delayMs=100"
   
   # ‡πÄ‡∏Ç‡πâ‡∏≤‡∏î‡∏π Swagger UI
   # ‡πÑ‡∏õ‡∏ó‡∏µ‡πà: https://observability-upstream.azurewebsites.net/swagger
   ```

### ‡∏ó‡∏î‡∏™‡∏≠‡∏ö Azure Deployment

‡∏´‡∏•‡∏±‡∏á‡∏à‡∏≤‡∏Å deploy ‡∏Ç‡∏∂‡πâ‡∏ô Azure ‡πÅ‡∏•‡πâ‡∏ß ‡∏•‡∏≠‡∏á‡∏ó‡∏î‡∏™‡∏≠‡∏ö endpoints:

```powershell
# Health checks
Invoke-RestMethod https://your-downstream-app.azurewebsites.net/health
Invoke-RestMethod https://your-upstream-app.azurewebsites.net/health

# Product endpoint ‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏à‡∏≥‡∏•‡∏≠‡∏á‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ä‡πâ‡∏≤
Invoke-RestMethod "https://your-upstream-app.azurewebsites.net/gateway/products/123?delayMs=500"

# Order endpoint ‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏à‡∏≥‡∏•‡∏≠‡∏á‡∏Ñ‡∏ß‡∏≤‡∏°‡∏•‡πâ‡∏°‡πÄ‡∏´‡∏•‡∏ß
Invoke-RestMethod -Uri "https://your-upstream-app.azurewebsites.net/gateway/orders?failureMode=transient" -Method Post

# ‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡πÅ‡∏£‡∏á‡∏î‡∏±‡∏ô CPU
Invoke-RestMethod "https://your-downstream-app.azurewebsites.net/pressure/cpu?iterations=100000"

# ‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡πÅ‡∏£‡∏á‡∏î‡∏±‡∏ô memory
Invoke-RestMethod "https://your-downstream-app.azurewebsites.net/pressure/memory?mbToAllocate=50"

# ‡∏ó‡∏î‡∏™‡∏≠‡∏ö bug ‡∏Ç‡∏±‡πâ‡∏ô‡∏™‡∏π‡∏á (‡∏ñ‡πâ‡∏≤‡πÄ‡∏õ‡∏¥‡∏î‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô)
cd test-data-generator
dotnet run -- https://your-upstream-app.azurewebsites.net all
```

## Monitoring ‡πÉ‡∏ô Azure üìà

### ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå‡πÉ‡∏ô Azure Application Insights

#### Transaction ‡∏ó‡∏µ‡πà‡∏ä‡πâ‡∏≤
![Slow Transactions](./documents/result_slow_transection_in_azure.png)
*‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡πÅ‡∏™‡∏î‡∏á transaction ‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ä‡πâ‡∏≤‡πÉ‡∏ô Azure Application Insights*

![Multiple Slow Transactions](./documents/result_many_slow_transection_in_azure.png)
*‡∏Å‡∏≤‡∏£‡πÅ‡∏™‡∏î‡∏á transaction ‡∏ó‡∏µ‡πà‡∏ä‡πâ‡∏≤‡∏´‡∏•‡∏≤‡∏¢‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏Å‡∏±‡∏ô*

#### ‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏à‡∏±‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏•‡πâ‡∏°‡πÄ‡∏´‡∏•‡∏ß
![Failed Transactions](./documents/result_fail_transection_in_azure_by_calling_api.png)
*‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡πÅ‡∏™‡∏î‡∏á failed transactions ‡∏à‡∏≤‡∏Å‡∏Å‡∏≤‡∏£‡πÄ‡∏£‡∏µ‡∏¢‡∏Å API*

#### ‡∏Å‡∏≤‡∏£ Monitor CPU ‡πÅ‡∏•‡∏∞ Memory
![CPU Peak](./documents/result_cpu_peak_in_azure.png)
*‡∏Å‡∏£‡∏≤‡∏ü‡πÅ‡∏™‡∏î‡∏á CPU spike ‡πÉ‡∏ô Azure Monitor*

![Live Monitoring](./documents/result_cpu_ram_peak_in_azure_live_monitor.png)
*Live monitoring ‡πÅ‡∏™‡∏î‡∏á CPU ‡πÅ‡∏•‡∏∞ Memory usage ‡πÅ‡∏ö‡∏ö real-time*

### Application Insights Queries

‡πÄ‡∏Ç‡πâ‡∏≤ Application Insights ‡πÉ‡∏ô Azure Portal ‡πÅ‡∏•‡πâ‡∏ß‡∏•‡∏≠‡∏á KQL queries ‡πÄ‡∏´‡∏•‡πà‡∏≤‡∏ô‡∏µ‡πâ:

1. **‡∏î‡∏π Request ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î**
   ```kusto
   requests
   | where timestamp > ago(1h)
   | summarize count() by name, resultCode
   | order by count_ desc
   ```

2. **‡∏ï‡∏≤‡∏°‡∏£‡∏≠‡∏¢ Request Flow**
   ```kusto
   requests
   | where name contains "gateway"
   | join kind=inner (dependencies | where name contains "products" or name contains "orders") on operation_Id
   | project timestamp, request_name = name, dependency_name = name1, duration, resultCode
   ```

3. **‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå Performance**
   ```kusto
   requests
   | where timestamp > ago(1h)
   | summarize avg(duration), max(duration), min(duration) by name
   | order by avg_duration desc
   ```

4. **‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå Error**
   ```kusto
   requests
   | where success == false
   | summarize count() by name, resultCode, problemId
   | order by count_ desc
   ```

### ‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á Alerts

1. **‡∏™‡∏£‡πâ‡∏≤‡∏á Alert ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Error Rate ‡∏™‡∏π‡∏á**
   ```powershell
   az monitor metrics alert create `
     --name "High Error Rate" `
     --resource-group observability-rg-west `
     --scopes /subscriptions/{subscription-id}/resourceGroups/observability-rg-west/providers/Microsoft.Insights/components/observability-insights `
     --condition "count requests/failed > 10" `
     --window-size 5m `
     --evaluation-frequency 1m
   ```

2. **‡∏™‡∏£‡πâ‡∏≤‡∏á Alert ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Response Time ‡∏™‡∏π‡∏á**
   ```powershell
   az monitor metrics alert create `
     --name "High Response Time" `
     --resource-group observability-rg-west `
     --scopes /subscriptions/{subscription-id}/resourceGroups/observability-rg-west/providers/Microsoft.Insights/components/observability-insights `
     --condition "avg requests/duration > 2000" `
     --window-size 5m `
     --evaluation-frequency 1m
   ```

## ‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏Ñ‡πà‡∏≤‡πÉ‡∏ä‡πâ‡∏à‡πà‡∏≤‡∏¢ üí∞

- **App Service**: B1 tier ‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì $13/‡πÄ‡∏î‡∏∑‡∏≠‡∏ô  
- **Application Insights**: 5GB ‡πÅ‡∏£‡∏Å‡∏ü‡∏£‡∏µ ‡∏´‡∏•‡∏±‡∏á‡∏à‡∏≤‡∏Å‡∏ô‡∏±‡πâ‡∏ô $2.30/GB

‡∏ß‡∏¥‡∏ò‡∏µ‡∏õ‡∏£‡∏∞‡∏´‡∏¢‡∏±‡∏î‡∏Ñ‡πà‡∏≤‡πÉ‡∏ä‡πâ‡∏à‡πà‡∏≤‡∏¢:
1. ‡πÉ‡∏ä‡πâ F1 (Free) ‡∏´‡∏£‡∏∑‡∏≠ B1 App Service tier ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏£‡∏π‡πâ
2. ‡∏•‡∏ö resources ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πâ: `az group delete --name observability-rg-west`
3. ‡∏Ñ‡∏≠‡∏¢ monitor ‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ô Application Insights

## ‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏ï‡πà‡∏≠‡πÑ‡∏õ üéØ

1. **Deploy ‡∏Ç‡∏∂‡πâ‡∏ô Azure** ‡∏î‡πâ‡∏ß‡∏¢‡∏ß‡∏¥‡∏ò‡∏µ‡πÉ‡∏î‡∏ß‡∏¥‡∏ò‡∏µ‡∏´‡∏ô‡∏∂‡πà‡∏á‡∏Ç‡πâ‡∏≤‡∏á‡∏ö‡∏ô
2. **‡∏£‡∏±‡∏ô load tests** ‡∏Å‡∏±‡∏ö Azure endpoints ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏™‡∏£‡πâ‡∏≤‡∏á telemetry
3. **‡∏™‡∏£‡πâ‡∏≤‡∏á custom dashboards** ‡πÉ‡∏ô Application Insights
4. **‡∏ï‡∏±‡πâ‡∏á alerts** ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÄ‡∏á‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏Ç‡∏Ñ‡∏ß‡∏≤‡∏°‡∏•‡πâ‡∏°‡πÄ‡∏´‡∏•‡∏ß‡∏ï‡πà‡∏≤‡∏á‡πÜ
5. **‡∏ù‡∏∂‡∏Å‡∏ï‡∏≠‡∏ö‡∏™‡∏ô‡∏≠‡∏á incident** ‡∏î‡πâ‡∏ß‡∏¢ Azure monitoring tools
6. **‡∏™‡∏≥‡∏£‡∏ß‡∏à Log Analytics** ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö query ‡∏Ç‡∏±‡πâ‡∏ô‡∏™‡∏π‡∏á

## License üìÑ

‡∏ô‡∏µ‡πà‡∏Ñ‡∏∑‡∏≠‡πÅ‡∏û‡∏•‡∏ï‡∏ü‡∏≠‡∏£‡πå‡∏°‡∏Å‡∏≤‡∏£‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏£‡∏π‡πâ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤‡∏Ñ‡∏£‡∏±‡∏ö!